<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>G·ª≠i Trao NƒÉm M·ªõi 2026</title>
    <link
        href="https://fonts.googleapis.com/css2?family=Lora:ital,wght@0,400;0,500;1,400&family=Dancing+Script:wght@400;700&display=swap"
        rel="stylesheet">
    <style>
        /* --- GLOBAL RESET & FONTS --- */
        :root {
            --bg-night: #0a0a0a;
            --text-gold: #ffbd69;
            --accent-red: #8a2323;
            --fire-glow: rgba(255, 120, 0, 0.6);
            --paper-bg: #fdfaf1;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Lora', serif;
            background-color: var(--bg-night);
            color: #fff;
            overflow: hidden;
            /* NgƒÉn cu·ªôn trang ch√≠nh */
            height: 100vh;
            width: 100vw;
            /* Ch·ªëng rung khi scroll tr√™n mobile */
            overscroll-behavior: none;
        }

        /* --- BACKGROUND SAO & SAO BƒÇNG --- */
        #star-bg {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -2;
            background: radial-gradient(ellipse at bottom, #1B2735 0%, #090A0F 100%);
            overflow: hidden;
        }

        #meteor-canvas {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            pointer-events: none;
        }

        .star {
            position: absolute;
            background: white;
            border-radius: 50%;
            animation: twinkle var(--duration) infinite ease-in-out;
            opacity: var(--opacity);
        }

        @keyframes twinkle {

            0%,
            100% {
                opacity: 0.2;
            }

            50% {
                opacity: 1;
            }
        }

        /* --- LOGIC CHUY·ªÇN TRANG --- */
        .page {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: none;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            opacity: 0;
            z-index: 10;
            padding: 20px;
            /* Th√™m padding ƒë·ªÉ n·ªôi dung kh√¥ng s√°t l·ªÅ mobile */
        }

        .page.active {
            display: flex;
            opacity: 1;
            pointer-events: auto;
        }

        .page-exit {
            animation: pageZoomOut 0.8s forwards ease-in;
            pointer-events: none;
        }

        .page-enter {
            display: flex;
            animation: pageZoomIn 1s forwards ease-out;
            pointer-events: auto;
        }

        @keyframes pageZoomOut {
            0% {
                opacity: 1;
                transform: scale(1);
                filter: blur(0);
            }

            100% {
                opacity: 0;
                transform: scale(1.2);
                filter: blur(10px);
            }
        }

        @keyframes pageZoomIn {
            0% {
                opacity: 0;
                transform: scale(0.8);
                filter: blur(10px);
            }

            100% {
                opacity: 1;
                transform: scale(1);
                filter: blur(0);
            }
        }

        /* --- STYLE CHO N√öT B·∫§M (RESPONSIVE) --- */
        .btn-general {
            margin-top: 20px;
            padding: 12px 30px;
            /* TƒÉng v√πng b·∫•m cho c·∫£m ·ª©ng */
            background: transparent;
            color: #fff;
            border: 1px solid rgba(255, 255, 255, 0.5);
            border-radius: 30px;
            cursor: pointer;
            font-family: 'Dancing Script', cursive;
            font-size: clamp(1.2rem, 4vw, 1.5rem);
            /* T·ª± ƒë·ªông ch·ªânh size ch·ªØ n√∫t */
            transition: 0.3s;
            touch-action: manipulation;
            /* T·ªëi ∆∞u cho touch */
        }

        .btn-general:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: scale(1.1);
            box-shadow: 0 0 15px rgba(255, 255, 255, 0.3);
        }

        /* --- PAGE 1: NH·∫¨P T√äN --- */
        #page-1 input {
            background: transparent;
            border: none;
            border-bottom: 2px solid #fff;
            color: var(--text-gold);
            font-family: 'Dancing Script', cursive;
            font-size: clamp(1.5rem, 5vw, 2.5rem);
            text-align: center;
            outline: none;
            padding: 10px;
            width: 100%;
            max-width: 300px;
        }

        #page-1 h2 {
            font-weight: normal;
            margin-bottom: 20px;
            font-size: clamp(1rem, 4vw, 1.5rem);
            opacity: 0.8;
            text-align: center;
        }

        /* --- PAGE 2: THI·ªÜP (B·ª®C TH∆Ø - RESPONSIVE) --- */
        .letter-container {
            background: var(--paper-bg);
            color: #2c3e50;
            padding: 40px 30px;
            border-radius: 2px;
            width: 100%;
            max-width: 550px;
            /* Gi·ªõi h·∫°n chi·ªÅu r·ªông tr√™n Desktop */
            /* X·ª≠ l√Ω chi·ªÅu cao tr√™n Mobile xoay ngang */
            max-height: 85vh;
            overflow-y: auto;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.5), inset 0 0 50px rgba(0, 0, 0, 0.05);
            position: relative;
            transform: rotate(-1deg);
            animation: slideIn 1.2s ease-out forwards;
        }

        .letter-container::before {
            content: '';
            position: absolute;
            top: 0;
            right: 0;
            border-width: 0 40px 40px 0;
            border-style: solid;
            border-color: #ddd var(--bg-night) #ddd #ddd;
            display: block;
            width: 0;
        }

        .letter-container h1 {
            font-family: 'Dancing Script', cursive;
            font-size: clamp(1.8rem, 5vw, 2.5rem);
            color: var(--accent-red);
            margin-bottom: 20px;
            border-bottom: 1px solid rgba(138, 35, 35, 0.2);
            padding-bottom: 10px;
        }

        .letter-content {
            font-size: clamp(1rem, 3.5vw, 1.2rem);
            line-height: 1.6;
            min-height: 150px;
            text-align: left;
            font-style: italic;
        }

        .letter-footer {
            margin-top: 20px;
            text-align: right;
            font-family: 'Dancing Script', cursive;
            font-size: clamp(1.1rem, 4vw, 1.3rem);
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(50px) rotate(-3deg);
            }

            to {
                opacity: 1;
                transform: translateY(0) rotate(-1deg);
            }
        }

        /* --- PAGE 3: CHOICE --- */
        .card {
            width: 90%;
            max-width: 600px;
            padding: 30px 20px !important;
            /* Ghi ƒë√® inline style */
        }

        .card h1 {
            font-size: clamp(2rem, 8vw, 3rem) !important;
        }

        .choice-btn-group {
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
            justify-content: center;
        }

        /* --- PAGE 3: INTERACTIVE (SCROLLABLE) --- */
        #page-3-interactive {
            display: none;
            overflow-y: auto;
            /* Cho ph√©p cu·ªôn d·ªçc */
            overflow-x: hidden;
            background-color: var(--bg-night);
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 20;
            -webkit-overflow-scrolling: touch;
            /* M∆∞·ª£t h∆°n tr√™n iOS */
        }

        .interactive-container {
            max-width: 700px;
            margin: 0 auto;
            padding: 20px;
            position: relative;
            z-index: 100;
            padding-bottom: 100px;
        }

        .interactive-section {
            min-height: 90vh;
            /* M·ªói ph·∫ßn chi·∫øm g·∫ßn tr·ªçn m√†n h√¨nh */
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            opacity: 0;
            transform: translateY(20px);
            transition: opacity 1s, transform 1s;
            padding: 20px 0;
        }

        .interactive-section.visible {
            opacity: 1;
            transform: translateY(0);
        }

        .interactive-title {
            font-family: 'Dancing Script', cursive;
            font-size: clamp(2rem, 6vw, 3rem);
            /* Responsive text */
            margin-bottom: 20px;
            color: var(--text-gold);
            text-shadow: 0 0 10px var(--fire-glow);
            text-align: center;
        }

        /* --- Element: N·ªìi B√°nh Ch∆∞ng --- */
        .pot-container {
            position: relative;
            width: 120px;
            height: 100px;
            background: #3e2723;
            border-radius: 10px 10px 40px 40px;
            margin: 40px auto;
            /* Margin g·ªçn h∆°n */
            box-shadow: 0 0 50px var(--fire-glow);
            animation: flicker 3s infinite alternate;
            transform-origin: center;
        }

        /* Mobile Scale cho n·ªìi */
        @media (max-width: 400px) {
            .pot-container {
                transform: scale(0.8);
                margin: 30px auto;
            }
        }

        .pot-lid {
            width: 130px;
            height: 20px;
            background: #5d4037;
            position: absolute;
            top: -10px;
            left: -5px;
            border-radius: 5px;
            animation: rumble 0.5s infinite;
        }

        .steam {
            position: absolute;
            top: -20px;
            left: 50%;
            transform: translateX(-50%);
            color: rgba(255, 255, 255, 0.8);
            font-family: 'Dancing Script', cursive;
            font-size: 1.2rem;
            white-space: nowrap;
            animation: steamUpNatural 4s ease-out forwards;
            opacity: 0;
            pointer-events: none;
            text-shadow: 0 0 5px rgba(255, 255, 255, 0.5);
        }

        /* --- Element: ƒê√®n D·∫ßu --- */
        .lamp {
            width: 40px;
            height: 60px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 50% 50% 10% 10%;
            position: relative;
            margin: 20px auto;
            display: flex;
            justify-content: center;
            overflow: hidden;
            box-shadow: 0 0 10px rgba(255, 255, 255, 0.1);
        }

        .flame {
            width: 14px;
            height: 30px;
            background: linear-gradient(to top, orangered, orange, yellow);
            border-radius: 50% 50% 20% 20%;
            position: absolute;
            bottom: 5px;
            box-shadow: 0 0 15px orange;
            opacity: 0.8;
            animation: flickerSmall 0.2s infinite alternate;
            transform-origin: bottom center;
            transition: all 0.5s;
        }

        .flame.flare-up {
            animation: flameBurst 2s forwards;
        }

        .wish-input-wrapper {
            position: relative;
            width: 90%;
            max-width: 400px;
            margin: 0 auto;
            height: 50px;
        }

        .wish-input,
        textarea {
            width: 100%;
            background: transparent;
            border: none;
            border-bottom: 1px solid #777;
            color: inherit;
            text-align: center;
            padding: 10px;
            font-family: 'Dancing Script', cursive;
            font-size: 1.5rem;
            outline: none;
            display: block;
        }

        textarea {
            font-family: 'Lora', serif;
            font-size: 1rem;
            width: 90%;
            max-width: 400px;
            resize: none;
            margin: 0 auto;
            display: block;
        }

        .ash-text {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            font-family: 'Dancing Script', cursive;
            font-size: 1.5rem;
            text-align: center;
            pointer-events: none;
            display: none;
            /* X·ª≠ l√Ω text d√†i tr√™n mobile */
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .turn-to-ash {
            animation: ashDissolve 3s forwards ease-in-out;
            display: block !important;
        }

        /* --- Element: C·ª≠a s·ªï (Responsive) --- */
        .window-frame {
            /* Thay ƒë·ªïi width/height c·ªë ƒë·ªãnh th√†nh t∆∞∆°ng ƒë·ªëi */
            width: 80vw;
            max-width: 300px;
            height: 50vh;
            max-height: 400px;
            border: 8px solid #3e2723;
            background: radial-gradient(ellipse at bottom, #1B2735 0%, #090A0F 100%);
            position: relative;
            overflow: hidden;
            border-radius: 4px;
            margin: 0 auto;
        }

        #window-meteor-canvas {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 5;
        }

        /* --- Element: L√¨ x√¨ --- */
        .envelope {
            width: 120px;
            height: 180px;
            background: var(--accent-red);
            margin: 30px auto;
            position: relative;
            cursor: pointer;
            border-radius: 5px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.5);
            display: flex;
            justify-content: center;
            align-items: center;
            transition: transform 0.5s;
        }

        .envelope::after {
            content: 'üßß';
            font-size: 2rem;
        }

        .lucky-note {
            display: none;
            background: #fff5e6;
            color: #8a2323;
            padding: 20px;
            border-radius: 5px;
            width: 90%;
            max-width: 400px;
            margin: 20px auto;
            font-family: 'Dancing Script', cursive;
            font-size: 1.3rem;
            animation: unfold 1s ease;
            text-align: center;
        }

        /* --- KEYFRAMES --- */
        @keyframes steamUpNatural {
            0% {
                top: -20px;
                opacity: 0;
                transform: translateX(-50%) scale(0.5);
            }

            20% {
                opacity: 1;
                transform: translateX(-55%) scale(1);
            }

            50% {
                transform: translateX(-45%) scale(1.1);
            }

            100% {
                top: -150px;
                opacity: 0;
                transform: translateX(-50%) scale(1.5);
                filter: blur(2px);
            }
        }

        @keyframes flicker {
            0% {
                opacity: 0.8;
                transform: scale(1);
            }

            100% {
                opacity: 1;
                transform: scale(1.05);
            }
        }

        @keyframes flickerSmall {
            0% {
                opacity: 0.7;
                transform: scale(0.8);
            }

            100% {
                opacity: 0.9;
                transform: scale(0.9);
            }
        }

        @keyframes rumble {
            0% {
                transform: rotate(0deg);
            }

            25% {
                transform: rotate(1deg);
            }

            75% {
                transform: rotate(-1deg);
            }
        }

        @keyframes unfold {
            from {
                transform: scaleY(0);
            }

            to {
                transform: scaleY(1);
            }
        }

        @keyframes flameBurst {
            0% {
                transform: scale(0.9);
                filter: brightness(1);
            }

            20% {
                transform: scale(1.6);
                filter: brightness(1.5);
                box-shadow: 0 0 60px orangered;
            }

            80% {
                transform: scale(1.4);
                filter: brightness(1.2);
            }

            100% {
                transform: scale(0.9);
                filter: brightness(1);
            }
        }

        @keyframes ashDissolve {
            0% {
                color: #fff;
                opacity: 1;
                transform: translateY(0) scale(1);
            }

            30% {
                color: #333;
                text-shadow: 0 0 15px orangered;
                transform: translateY(-20px) scale(1.1);
            }

            60% {
                color: #888;
                text-shadow: none;
                filter: blur(4px);
                letter-spacing: 5px;
                opacity: 0.5;
            }

            100% {
                color: transparent;
                transform: translateY(-150px) scale(1.5);
                filter: blur(15px);
                letter-spacing: 20px;
                opacity: 0;
            }
        }

        /* --- PAGE 4: FINALE --- */
        #happy-new-year {
            position: absolute;
            top: 40%;
            left: 0;
            width: 100%;
            text-align: center;
            opacity: 0;
            pointer-events: none;
            transition: opacity 3s ease;
            z-index: 200;
            padding: 0 10px;
            /* Tr√°nh s√°t l·ªÅ mobile */
        }

        #happy-new-year h1 {
            font-family: 'Dancing Script', cursive;
            font-size: clamp(2.5rem, 8vw, 5rem);
            /* T·ª± ƒë·ªông ch·ªânh size ch·ªØ */
            color: #fff;
            text-shadow: 0 0 30px rgba(255, 255, 255, 1), 0 0 60px #ffbd69;
            line-height: 1.2;
        }

        #happy-new-year p {
            font-size: clamp(1rem, 4vw, 1.5rem);
            margin-top: 10px;
            letter-spacing: 2px;
            text-shadow: 0 0 10px rgba(255, 255, 255, 0.5);
        }

        #fireworksCanvas {
            display: block;
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
        }

        /* --- MEDIA QUERIES B·ªî SUNG CHO MOBILE NH·ªé --- */
        @media (max-width: 600px) {
            .letter-container {
                padding: 30px 20px;
                width: 95%;
            }

            /* ƒê·∫©y n√∫t xu·ªëng ch√∫t ƒë·ªÉ kh√¥ng b·ªã d√≠nh */
            .btn-general {
                margin-top: 25px;
            }
        }
    </style>
</head>

<body>
    <audio id="bg-music" src="snaptik.vn_MKmpp.mp4 2.mp3" loop></audio>
    <div id="star-bg"></div>
    <canvas id="meteor-canvas"></canvas>

    <div id="page-1" class="page active">
        <h2>Ch√†o b·∫°n, t√™n b·∫°n l√† g√¨ n√®?</h2>
        <input type="text" id="name-input" placeholder="Nh·∫≠p t√™n c·ªßa b·∫°n..." autocomplete="off">
        <button class="btn-general" onclick="goToPage2()">Ti·∫øp t·ª•c</button>
    </div>

    <div id="page-2" class="page">
        <div class="letter-container">
            <h1>G·ª≠i <span id="display-name">...</span>,</h1>
            <div id="typewriter-text" class="letter-content"></div>
            <div class="letter-footer" id="letter-footer" style="opacity: 0; transition: 1s;">
                K√Ω t√™n: Tui n√® (G·ª≠i t·ª´ 2026)
            </div>
            <p id="wait-message"
                style="display:none; text-align: center; font-size: 0.9rem; margin-top: 25px; color: #888; font-style: italic; font-family: 'Lora', serif;">
                ƒê·ª£i 1 x√≠u nh√©...
            </p>
        </div>
    </div>

    <div id="page-3-choice" class="page">
        <div class="card"
            style="text-align: center; background: rgba(255,255,255,0.05); backdrop-filter: blur(10px); border-radius: 15px;">
            <h1 style="font-family: 'Dancing Script', cursive; color: var(--text-gold);">G·ª≠i G·∫Øm T∆∞∆°ng Lai</h1>
            <p style="margin: 20px 0; font-size: clamp(1rem, 3vw, 1.2rem);">B·∫°n c√≥ mong ∆∞·ªõc g√¨ g·ª≠i g·∫Øm cho ch√≠nh m√¨nh
                trong t∆∞∆°ng lai kh√¥ng?</p>
            <div class="choice-btn-group">
                <button class="btn-general" onclick="startInteractiveMode()">C√≥ ch·ª©</button>
                <button class="btn-general" onclick="goToPage4()">Kh√¥ng, ƒë·∫øn giao th·ª´a th√¥i</button>
            </div>
        </div>
    </div>

    <div id="page-3-interactive">

        <div class="interactive-container">
            <section class="interactive-section visible">
                <h2 class="interactive-title">B·∫øp l·ª≠a nƒÉm m·ªõi</h2>
                <div class="pot-container">
                    <div class="pot-lid"></div>
                    <div id="steam-container"></div>
                </div>
                <p style="text-align: center; color: #e6dace; padding: 0 10px;">B√™n n·ªìi b√°nh ch∆∞ng ƒëang s√¥i, nh·ªØng mong
                    c·∫ßu ƒëang bay l√™n.</p>
            </section>

            <section class="interactive-section">
                <h2 class="interactive-title">G·ª≠i L·∫°i NƒÉm C≈©</h2>
                <div class="lamp">
                    <div class="flame" id="lamp-flame"></div>
                </div>
                <div class="wish-input-wrapper">
                    <input type="text" class="wish-input" id="wish-input-old"
                        placeholder="M·ªôt n·ªói bu·ªìn mu·ªën bu√¥ng b·ªè..." autocomplete="off">
                    <div id="ash-display" class="ash-text"></div>
                </div>

                <button class="btn-general" onclick="lightLamp()" style="display: block; margin: 20px auto;">Th·∫Øp ƒë√®n &
                    H√≥a gi·∫£i</button>
            </section>

            <section class="interactive-section">
                <h2 class="interactive-title">Khung C·ª≠a Nguy·ªán C·∫ßu</h2>
                <div class="window-frame" id="window-frame">
                    <div id="stars-layer-window" style="width:100%; height:100%;"></div>
                    <canvas id="window-meteor-canvas"></canvas>
                </div>
                <textarea id="reflection-input" rows="1" placeholder="G·ª≠i v√†o ƒë√¢y m·ªôt hy v·ªçng..."
                    style="margin-top:20px; color: #e6dace;"></textarea>
                <button class="btn-general" onclick="sendWish()" style="display: block; margin: 20px auto;">G·ª≠i ni·ªÅm hy
                    v·ªçng</button>
                <p id="window-feedback"
                    style="text-align:center; font-size: 0.8rem; margin-top: 10px; opacity: 0; transition: opacity 1s;">
                    V≈© tr·ª• ƒë√£ l·∫Øng nghe.</p>
            </section>

            <section class="interactive-section">
                <h2 class="interactive-title">L·ªôc ƒê·∫ßu NƒÉm</h2>
                <p style="text-align: center; color: #e6dace; padding: 0 10px;">Kh√¥ng ph·∫£i ti·ªÅn b·∫°c. ƒê√¢y l√† ch√∫t v·ªën
                    li·∫øng tinh th·∫ßn cho b·∫°n.</p>
                <div class="envelope" onclick="openEnvelope()"></div>
                <div id="lucky-note" class="lucky-note"></div>
            </section>

            <section class="interactive-section">
                <h2 class="interactive-title">C√πng nhau ng·∫Øm ph√°o hoa nh√©</h2>
                <p style="text-align: center; color: #e6dace; padding: 0 10px;">Th·ªùi kh·∫Øc r·ª±c r·ª° nh·∫•t ƒë√£ ƒë·∫øn r·ªìi.</p>
                <button class="btn-general" onclick="goToPage4()">B·∫Øt ƒë·∫ßu th√¥i n√†o</button>
            </section>
        </div>
    </div>

    <div id="page-4" class="page">
        <canvas id="fireworksCanvas"></canvas>
        <div id="happy-new-year">
            <h1>Happy New Year 2026</h1>
            <p>R·ª±c r·ª° - B√¨nh An - H·∫°nh Ph√∫c</p>
        </div>
    </div>

    <script>
        // --- GLOBAL BACKGROUND MUSIC ---
        const bgMusic = document.getElementById('bg-music');
        let musicStarted = false;

        function startMusicOnce() {
            if (musicStarted) return;
            bgMusic.volume = 0.6;
            bgMusic.play().catch(() => { });
            musicStarted = true;
            document.removeEventListener('click', startMusicOnce);
            document.removeEventListener('touchstart', startMusicOnce);
        }

        document.addEventListener('click', startMusicOnce);
        document.addEventListener('touchstart', startMusicOnce);

        // --- 1. SETUP CHUNG ---
        function createStars() {
            const bg = document.getElementById('star-bg');
            for (let i = 0; i < 100; i++) {

                const s = document.createElement('div');
                s.className = 'star';
                const size = Math.random() * 2 + 1;
                s.style.width = size + 'px';
                s.style.height = size + 'px';
                s.style.left = Math.random() * 100 + '%';

                s.style.top = Math.random() * 100 + '%';
                s.style.setProperty('--duration', (Math.random() * 3 + 2) + 's');
                s.style.setProperty('--opacity', Math.random());
                bg.appendChild(s);
            }
        }
        createStars();
        // --- ENGINE SAO BƒÇNG ---
        class MeteorEngine {
            constructor(canvasId, isWindow = false) {
                this.canvas = document.getElementById(canvasId);
                this.ctx = this.canvas.getContext('2d');
                this.meteors = [];
                this.width = 0;
                this.height = 0;
                this.isWindow = isWindow;
                this.resize();
                if (!isWindow) {
                    window.addEventListener('resize', () => this.resize());
                } else {
                    // Update: Listen to window resize for window frame too
                    window.addEventListener('resize', () => this.resizeWindowFrame());
                    this.resizeWindowFrame();
                }
                this.animate();
            }

            resize() {
                this.width = window.innerWidth;
                this.height = window.innerHeight;
                this.canvas.width = this.width;
                this.canvas.height = this.height;
            }

            resizeWindowFrame() {
                // Ensure canvas matches the responsive div size
                const rect = this.canvas.parentElement.getBoundingClientRect();
                this.width = rect.width;
                this.height = rect.height;
                this.canvas.width = this.width;
                this.canvas.height = this.height;
            }

            shoot(forced = false) {
                let chance = this.isWindow ?
                    0.01 : 0.02;
                if (!forced && Math.random() > chance) return;
                this.meteors.push(new Meteor(this.width, this.height, this.isWindow));
            }

            animate() {
                this.ctx.clearRect(0, 0, this.width, this.height);
                this.shoot();

                for (let i = 0; i < this.meteors.length; i++) {
                    this.meteors[i].update();
                    this.meteors[i].draw(this.ctx);

                    if (this.meteors[i].isDead()) {
                        this.meteors.splice(i, 1);
                        i--;
                    }
                }
                requestAnimationFrame(() => this.animate());
            }
        }

        class Meteor {
            constructor(w, h, isWindow) {
                this.isWindow = isWindow;
                if (isWindow) {
                    this.x = Math.random() * w;
                    this.y = Math.random() * (h * 0.4);
                    this.len = Math.random() * 40 + 30;
                    this.speed = Math.random() * 2 + 5;
                    this.size = Math.random() + 0.5;
                } else {
                    this.x = Math.random() * w;
                    this.y = Math.random() * h * 0.5;
                    this.len = Math.random() * 200 + 100;
                    this.speed = Math.random() * 10 + 20;
                    this.size = Math.random() * 2 + 0.5;
                }

                this.angle = Math.PI / 4 + (Math.random() * 0.2 - 0.1);
                this.vx = Math.cos(this.angle) * this.speed;
                this.vy = Math.sin(this.angle) * this.speed;
                this.opacity = 1;
            }

            update() {
                this.x += this.vx;
                this.y += this.vy;
                this.opacity -= 0.015;
            }

            draw(ctx) {
                const tailX = this.x - Math.cos(this.angle) * this.len;
                const tailY = this.y - Math.sin(this.angle) * this.len;

                const gradient = ctx.createLinearGradient(this.x, this.y, tailX, tailY);
                gradient.addColorStop(0, `rgba(255, 255, 255, ${this.opacity})`);
                gradient.addColorStop(1, `rgba(255, 255, 255, 0)`);

                ctx.beginPath();
                ctx.moveTo(this.x, this.y);
                ctx.lineTo(tailX, tailY);
                ctx.lineWidth = this.size;
                ctx.lineCap = 'round';
                ctx.strokeStyle = gradient;
                ctx.stroke();
                ctx.beginPath();
                ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
                ctx.fillStyle = `rgba(255, 255, 255, ${this.opacity})`;
                ctx.shadowBlur = 5;
                ctx.shadowColor = "white";
                ctx.fill();
                ctx.shadowBlur = 0;
            }

            isDead() {
                return this.opacity <= 0;
            }
        }

        const bgMeteorEngine = new MeteorEngine('meteor-canvas');
        // --- 2. LOGIC CHUY·ªÇN TRANG & B·ª®C TH∆Ø ---

        const wishesList = [
            "NƒÉm 2026 ƒë√£ g√µ c·ª≠a, ch√∫c c·∫≠u lu√¥n gi·ªØ v·ªØng phong ƒë·ªô h·ªçc t·∫≠p ƒë·ªânh cao, h·ªçc ƒë·∫øn ƒë√¢u nh·ªõ s√¢u ƒë·∫øn ƒë√≥ v√† √¥n t·∫≠p ƒë√∫ng tr·ªçng t√¢m ƒë·ªÅ thi. M·ª•c ti√™u Nguy·ªán v·ªçng 1 ƒëang ·ªü r·∫•t g·∫ßn, h√£y n·ªó l·ª±c h·∫øt m√¨nh trong giai ƒëo·∫°n n∆∞·ªõc r√∫t n√†y ƒë·ªÉ hi·ªán th·ª±c h√≥a ∆∞·ªõc m∆° tr·ªü th√†nh t√¢n sinh vi√™n nh√©, c·ªë l√™n!",
            "Ch√∫c sƒ© t·ª≠ nƒÉm 2026 c√≥ m·ªôt tinh th·∫ßn th√©p v√† √Ω ch√≠ ki√™n c∆∞·ªùng ƒë·ªÉ ƒë√°nh b·∫°i m·ªçi √°p l·ª±c thi c·ª≠ b·ªßa v√¢y. Mong r·∫±ng c·∫≠u s·∫Ω v∆∞·ª£t v≈© m√¥n h√≥a r·ªìng th√†nh c√¥ng, l√†m b√†i t·ª± tin v√† c·∫ßm ch·∫Øc t·∫•m gi·∫•y b√°o tr√∫ng tuy·ªÉn v√†o ƒë√∫ng ng√¥i tr∆∞·ªùng Nguy·ªán v·ªçng 1 m√† c·∫≠u h·∫±ng mong ∆∞·ªõc b·∫•y l√¢u nay.",
            "NƒÉm m·ªõi ch√∫c c·∫≠u ch√¢n c·ª©ng ƒë√° m·ªÅm, b√∫t s·∫Øc t√¢m an tr∆∞·ªõc m·ªçi th·ª≠ th√°ch c·ªßa k·ª≥ thi s·∫Øp t·ªõi. Mong r·∫±ng m·ªçi ƒë√™m th·ª©c khuya ƒë√®n s√°ch v√† nh·ªØng n·ªó l·ª±c kh√¥ng ng·ª´ng ngh·ªâ c·ªßa c·∫≠u s·∫Ω ƒë∆∞·ª£c ƒë·ªÅn ƒë√°p x·ª©ng ƒë√°ng b·∫±ng m·ªôt b·∫£ng ƒëi·ªÉm r·ª±c r·ª°, ƒë·ªß s·ª©c ƒë·ªÉ b∆∞·ªõc th·∫≥ng v√†o c√°nh c·ªïng ƒë·∫°i h·ªçc Nguy·ªán v·ªçng 1.",
            "Ch√∫c b·∫°n nƒÉm m·ªõi 2026 'c√° ch√©p h√≥a r·ªìng', b√¨nh tƒ©nh chinh ph·ª•c k·ª≥ thi t·ªët nghi·ªáp THPT Qu·ªëc gia v·ªõi k·∫øt qu·∫£ xu·∫•t s·∫Øc nh·∫•t. H√£y tin r·∫±ng Nguy·ªán v·ªçng 1 kh√¥ng c√≤n l√† m·ªôt gi·∫•c m∆° xa v·ªùi, m√† ch√≠nh l√† ƒë√≠ch ƒë·∫øn th·ª±c t·∫ø m√† b·∫°n ch·∫Øc ch·∫Øn s·∫Ω ch·∫°m tay v√†o b·∫±ng ch√≠nh t√†i nƒÉng v√† s·ª± c·ªë g·∫Øng c·ªßa m√¨nh.",
            "Ch√∫c c·∫≠u nƒÉm nay c√≥ m·ªôt s·ª©c kh·ªèe d·∫ªo dai v√† tr√≠ tu·ªá minh m·∫´n ƒë·ªÉ chi·∫øn ƒë·∫•u v·ªõi nh·ªØng t·∫≠p ƒë·ªÅ c∆∞∆°ng d√†y c·ªôm. Mong r·∫±ng khi b∆∞·ªõc v√†o ph√≤ng thi, c·∫≠u s·∫Ω khoanh ƒë√¢u ƒë√∫ng ƒë√≥, l√†m b√†i tr√¥i ch·∫£y v√† ƒë·∫°t s·ªë ƒëi·ªÉm tuy·ªát ƒë·ªëi ƒë·ªÉ hi√™n ngang b∆∞·ªõc v√†o ng√¥i tr∆∞·ªùng Nguy·ªán v·ªçng 1 m√† m√¨nh ƒë√£ l·ª±a ch·ªçn.",
            "G·ª≠i ƒë·∫øn c·∫≠u ngu·ªìn nƒÉng l∆∞·ª£ng ƒë·ªó ƒë·∫°t t√≠ch c·ª±c nh·∫•t cho nƒÉm 2026 r·ª±c r·ª°! Ch√∫c c·∫≠u √¥n t·∫≠p hi·ªáu qu·∫£, v∆∞·ª£t qua m·ªçi k·ª≥ thi kh·∫£o s√°t v·ªõi ƒëi·ªÉm s·ªë d·∫´n ƒë·∫ßu v√† cu·ªëi c√πng l√† t·ªèa s√°ng r·ª±c r·ª° tr√™n b·∫£ng v√†ng danh d·ª±, ch√≠nh th·ª©c tr·ªü th√†nh t√¢n sinh vi√™n ∆∞u t√∫ c·ªßa ng√¥i tr∆∞·ªùng ƒë·∫°i h·ªçc Nguy·ªán v·ªçng 1.",
            "NƒÉm m·ªõi ch√∫c c·∫≠u: VƒÉn ch∆∞∆°ng lai l√°ng, To√°n t√≠nh si√™u nhanh, Anh ng·ªØ th√¥ng th·∫°o v√† c√°c m√¥n t·ªï h·ª£p ƒë·ªÅu ƒë·∫°t ƒëi·ªÉm cao ch√≥t v√≥t. V·ªõi n·ªÅn t·∫£ng ki·∫øn th·ª©c v·ªØng ch·∫Øc v√† m·ªôt ch√∫t may m·∫Øn song h√†nh, tin r·∫±ng kh√¥ng g√¨ c√≥ th·ªÉ ngƒÉn c·∫£n b∆∞·ªõc ch√¢n c·∫≠u ti·∫øn th·∫≥ng v√†o gi·∫£ng ƒë∆∞·ªùng Nguy·ªán v·ªçng 1 y√™u th√≠ch.",
            "Ch√∫c c·∫≠u c√≥ m·ªôt m√πa thi 2026 ƒë·∫°i th·∫Øng v·ªõi ƒë·ªÅ thi v·ª´a s·ª©c, gi√°m th·ªã d·ªÖ t√≠nh v√† t√¢m l√Ω l√†m b√†i c·ª±c k·ª≥ ·ªïn ƒë·ªãnh. C·ªïng tr∆∞·ªùng ƒë·∫°i h·ªçc Nguy·ªán v·ªçng 1 ƒëang m·ªü r·ªông c√°nh c·ª≠a ch·ªù ƒë√≥n m·ªôt ng∆∞·ªùi x·ª©ng ƒë√°ng nh∆∞ c·∫≠u, h√£y c·ª© t·ª± tin v·ªØng b∆∞·ªõc v√¨ th√†nh c√¥ng ch·∫Øc ch·∫Øn ƒëang ƒë·ª£i c·∫≠u ·ªü ph√≠a tr∆∞·ªõc.",
            "NƒÉm 2026 n√†y, ch√∫c b·∫°n bi·∫øn nh·ªØng lo √¢u th√†nh ƒë·ªông l·ª±c m·∫°nh m·∫Ω ƒë·ªÉ b·ª©t ph√° trong h·ªçc t·∫≠p. Ch√∫c b·∫°n thi ƒë√¢u ƒë·∫≠u ƒë√≥, ƒë·∫°t k·∫øt qu·∫£ cao ngo√†i mong ƒë·ª£i ·ªü t·∫•t c·∫£ c√°c m√¥n thi v√† quan tr·ªçng nh·∫•t l√† tr√∫ng tuy·ªÉn v√†o ƒë√∫ng ng√†nh h·ªçc, ƒë√∫ng ng√¥i tr∆∞·ªùng ƒë·∫°i h·ªçc m√† b·∫°n ƒë√£ ƒë·∫∑t l√†m Nguy·ªán v·ªçng 1.",
            "T∆∞∆°ng lai t∆∞∆°i s√°ng ƒëang n·∫±m ngay trong t·∫ßm tay c·ªßa b·∫°n n·∫øu b·∫°n kh√¥ng ng·ª´ng n·ªó l·ª±c ngay t·ª´ h√¥m nay. Ch√∫c b·∫°n √¥n thi th·∫≠t hi·ªáu qu·∫£, gi·ªØ v·ªØng ni·ªÅm tin v√†o b·∫£n th√¢n v√† b·ª©t ph√° ngo·∫°n m·ª•c trong k·ª≥ thi t·ªõi ƒë·ªÉ ghi t√™n m√¨nh v√†o danh s√°ch tr√∫ng tuy·ªÉn ch√≠nh th·ª©c c·ªßa tr∆∞·ªùng ƒë·∫°i h·ªçc Nguy·ªán v·ªçng 1.",
            "Ch√∫c b·∫°n c√≥ m·ªôt tr√≠ nh·ªõ si√™u ph√†m ƒë·ªÉ th√¢u t√≥m m·ªçi ki·∫øn th·ª©c quan tr·ªçng v√† m·ªôt t√¢m th·∫ø b√¨nh tƒ©nh ƒë·ªÉ x·ª≠ l√Ω m·ªçi d·∫°ng b√†i t·∫≠p kh√≥. K·ª≥ thi nƒÉm 2026 s·∫Ω l√† n∆°i b·∫°n ch·ª©ng minh b·∫£n lƒ©nh c·ªßa m√¨nh, h√£y n·ªó l·ª±c h·∫øt s·ª©c ƒë·ªÉ nh·∫≠n v·ªÅ t·∫•m v√© v√†o th·∫≥ng tr∆∞·ªùng ƒë·∫°i h·ªçc Nguy·ªán v·ªçng 1 nhe!",
            "NƒÉm m·ªõi, ch√∫c m·ªçi gi·ªçt m·ªì h√¥i v√† c√¥ng s·ª©c b·∫°n ƒë·ªï xu·ªëng trang v·ªü ƒë·ªÅu ƒë∆∞·ª£c v≈© tr·ª• h·ªìi ƒë√°p b·∫±ng nh·ªØng ƒëi·ªÉm 9, ƒëi·ªÉm 10 ch√≥i l·ªçi. Ch√∫c b·∫°n ƒë·∫°t ƒë∆∞·ª£c s·ªë ƒëi·ªÉm d∆∞ d·∫£ ƒë·ªÉ kh√¥ng ch·ªâ ƒë·ªó m√† c√≤n ƒë·ªó v·ªõi th·ª© h·∫°ng cao v√†o ng√¥i tr∆∞·ªùng Nguy·ªán v·ªçng 1 m√† b·∫°n lu√¥n khao kh√°t theo ƒëu·ªïi.",
            "Ch√∫c b·∫°n v·ªØng tay b√∫t v√† s√°ng t√¢m tr√≠ trong su·ªët m√πa thi 2026. D√π ƒë·ªÅ thi c√≥ bi·∫øn h√≥a hay l·∫Øt l√©o ƒë·∫øn ƒë√¢u, mong b·∫°n v·∫´n gi·ªØ ƒë∆∞·ª£c s·ª± t·ªânh t√°o ƒë·ªÉ x·ª≠ l√Ω g·ªçn g√†ng, mang v·ªÅ k·∫øt qu·∫£ tr√∫ng tuy·ªÉn Nguy·ªán v·ªçng 1 nh∆∞ m·ªôt m√≥n qu√† tuy·ªát v·ªùi nh·∫•t d√†nh t·∫∑ng cho b·∫£n th√¢n v√† gia ƒë√¨nh.",
            "G·ª≠i t·ªõi c·∫≠u ng√†n l·ªùi ch√∫c may m·∫Øn v√† ni·ªÅm tin chi·∫øn th·∫Øng. Mong r·∫±ng ng√†y c√¥ng b·ªë ƒëi·ªÉm thi s·∫Ω l√† kho·∫£nh kh·∫Øc h·∫°nh ph√∫c nh·∫•t trong nƒÉm, khi c·∫≠u c√≥ th·ªÉ t·ª± h√†o khoe v·ªõi t·∫•t c·∫£ m·ªçi ng∆∞·ªùi r·∫±ng m√¨nh ƒë√£ ch√≠nh th·ª©c ƒë·ªó v√†o Nguy·ªán v·ªçng 1 v·ªõi m·ªôt s·ªë ƒëi·ªÉm c·ª±c k·ª≥ ·∫•n t∆∞·ª£ng v√† thuy·∫øt ph·ª•c.",
            "Ch√∫c b·∫°n nƒÉm 2026 chinh ph·ª•c th√†nh c√¥ng b∆∞·ªõc ngo·∫∑t l·ªõn nh·∫•t c·ªßa tu·ªïi h·ªçc tr√≤. H√£y gi·ªØ v·ªØng ng·ªçn l·ª≠a ƒëam m√™, t·∫≠p trung cao ƒë·ªô cho m·ª•c ti√™u ph√≠a tr∆∞·ªõc v√† bi·∫øn t·∫•m gi·∫•y b√°o nh·∫≠p h·ªçc tr∆∞·ªùng ƒë·∫°i h·ªçc Nguy·ªán v·ªçng 1 th√†nh hi·ªán th·ª±c ƒë·ªÉ b·∫Øt ƒë·∫ßu m·ªôt h√†nh tr√¨nh sinh vi√™n ƒë·∫ßy r·ª±c r·ª° v√† th√∫ v·ªã.",
            "Ch√∫c b·∫°n nƒÉm nay c√≥ chi·∫øn thu·∫≠t √¥n thi th√¥ng minh, 'h·ªçc √≠t hi·ªÉu nhi·ªÅu' v√† g·∫∑p ƒë√∫ng nh·ªØng d·∫°ng b√†i ƒë√£ chu·∫©n b·ªã k·ªπ. Mong th·∫ßn may m·∫Øn s·∫Ω lu√¥n m·ªâm c∆∞·ªùi v·ªõi b·∫°n trong ph√≤ng thi, gi√∫p b·∫°n ƒë·∫°t ƒë∆∞·ª£c t·ªïng ƒëi·ªÉm x√©t tuy·ªÉn cao ng·∫•t ng∆∞·ªüng ƒë·ªÉ c·∫ßm ch·∫Øc t·∫•m v√© tr√∫ng tuy·ªÉn Nguy·ªán v·ªçng 1 trong tay.",
            "M√πa thi 2026 n√†y, ch√∫c b·∫°n c√≥ m·ªôt t√¢m l√Ω v·ªØng v√†ng nh∆∞ b√†n th·∫°ch, kh√¥ng b·ªã xao ƒë·ªông b·ªüi √°p l·ª±c xung quanh. H√£y chi·∫øn ƒë·∫•u h·∫øt m√¨nh nh∆∞ m·ªôt chi·∫øn binh th·ª±c th·ª• tr√™n t·ªù gi·∫•y thi ƒë·ªÉ sau n√†y kh√¥ng ph·∫£i h·ªëi ti·∫øc, v√† ph·∫ßn th∆∞·ªüng x·ª©ng ƒë√°ng nh·∫•t ch√≠nh l√† c√°i g·∫≠t ƒë·∫ßu t·ª´ tr∆∞·ªùng Nguy·ªán v·ªçng 1.",
            "Ch√∫c b·∫°n kh√¥ng ch·ªâ ƒë∆°n thu·∫ßn l√† ƒë·ªó ƒë·∫°i h·ªçc, m√† c√≤n ph·∫£i ƒë·ªó v√†o ng√¥i tr∆∞·ªùng danh gi√° nh·∫•t trong danh s√°ch Nguy·ªán v·ªçng 1 c·ªßa m√¨nh. H√£y bi·∫øn nƒÉm 2026 th√†nh m·ªôt c·ªôt m·ªëc l·ªãch s·ª≠ r·ª±c r·ª° nh·∫•t c·ªßa tu·ªïi thanh xu√¢n b·∫±ng vi·ªác ghi danh v√†o ng√†nh h·ªçc m√† b·∫°n h·∫±ng m∆° ∆∞·ªõc b·∫•y l√¢u nay.",
            "M·ªçi s·ª± c·ªë g·∫Øng b·ªÅn b·ªâ c·ªßa b·∫°n ch·∫Øc ch·∫Øn s·∫Ω t·∫°o n√™n m·ªôt k·∫øt qu·∫£ phi th∆∞·ªùng trong k·ª≥ thi s·∫Øp t·ªõi. Ch√∫c b·∫°n ki√™n c∆∞·ªùng v∆∞·ª£t qua nh·ªØng ng√†y √¥n t·∫≠p v·∫•t v·∫£ ƒë·ªÉ g·∫∑t h√°i qu·∫£ ng·ªçt l√† th√¥ng b√°o tr√∫ng tuy·ªÉn Nguy·ªán v·ªçng 1, m·ªü ra m·ªôt trang m·ªõi ƒë·∫ßy h·ª©a h·∫πn cho t∆∞∆°ng lai ph√≠a tr∆∞·ªõc c·ªßa m√¨nh.",
            "Ch√∫c b·∫°n nƒÉm 2026: S√°ng su·ªët khi l·ª±a ch·ªçn kh·ªëi thi, b√¨nh tƒ©nh khi ƒë·ªëi m·∫∑t v·ªõi ƒë·ªÅ thi v√† v·ª° √≤a trong h·∫°nh ph√∫c khi nh·∫≠n ƒë∆∞·ª£c k·∫øt qu·∫£ tr√∫ng tuy·ªÉn. Con ƒë∆∞·ªùng d·∫´n ƒë·∫øn c·ªïng tr∆∞·ªùng ƒë·∫°i h·ªçc Nguy·ªán v·ªçng 1 ƒëang r·∫•t g·∫ßn r·ªìi, h√£y t·∫≠p trung t·ªëi ƒëa nƒÉng l∆∞·ª£ng ƒë·ªÉ v·ªÅ ƒë√≠ch th·∫≠t xu·∫•t s·∫Øc!",
            "ƒê·ª´ng qu√° lo l·∫Øng v√¨ v≈© tr·ª• lu√¥n th·∫•u hi·ªÉu v√† ·ªßng h·ªô nh·ªØng t√¢m h·ªìn chƒÉm ch·ªâ nh∆∞ b·∫°n. Ch√∫c b·∫°n c√≥ m·ªôt h√†nh tr√¨nh √¥n luy·ªán su√¥n s·∫ª, thi c·ª≠ thu·∫≠n l·ª£i 'bu·ªìm xu√¥i gi√≥' v√† ch·∫Øc ch·∫Øn ƒë·∫°t ƒë∆∞·ª£c k·∫øt qu·∫£ ƒë·ªó Nguy·ªán v·ªçng 1 ƒë·ªÉ b√π ƒë·∫Øp cho t·∫•t c·∫£ nh·ªØng ng√†y th√°ng mi·ªát m√†i b√™n trang s√°ch.",
            "Ch√∫c b·∫°n c√≥ ƒë·ªß b·∫£n lƒ©nh v√† s·ª± t·ª± tin ƒë·ªÉ v∆∞·ª£t qua m·ªçi th·ª≠ th√°ch, c·∫°m b·∫´y trong ƒë·ªÅ thi ch√≠nh th·ª©c. C√°nh c·ª≠a tr∆∞·ªùng ƒë·∫°i h·ªçc Nguy·ªán v·ªçng 1 kh√¥ng h·ªÅ xa x√¥i, n√≥ ch·ªâ c√°ch b·∫°n m·ªôt ch√∫t n·ªó l·ª±c v√† s·ª± c·∫©n th·∫≠n n·ªØa th√¥i, h√£y quy·∫øt t√¢m chi·∫øn th·∫Øng ƒë·ªÉ mang vinh quang v·ªÅ cho ch√≠nh m√¨nh!",
            "NƒÉm 2026 t·ªõi, ch√∫c b·∫°n c√≥ nh·ªØng tr·∫£i nghi·ªám h·ªçc t·∫≠p th√∫ v·ªã v√† ƒë·∫°t ƒë∆∞·ª£c b·ª©t ph√° trong t∆∞ duy. Ch√∫c b·∫°n ƒëi thi g·∫∑p ƒë√∫ng 't·ªß', l√†m b√†i nhanh g·ªçn v√† ch√≠nh x√°c ƒë·ªÉ k·∫øt qu·∫£ cu·ªëi c√πng l√† m·ªôt t·∫•m gi·∫•y b√°o nh·∫≠p h·ªçc Nguy·ªán v·ªçng 1 ƒë·ªè ch√≥t, minh ch·ª©ng cho t√†i nƒÉng c·ªßa b·∫°n.",
            "Ch√∫c b·∫°n m·ªôt nƒÉm m·ªõi t·∫≠p trung cao ƒë·ªô, bi·∫øt c√°ch g·∫°t b·ªè nh·ªØng c√°m d·ªó nh·∫•t th·ªùi ƒë·ªÉ d·ªìn to√†n l·ª±c cho m·ª•c ti√™u thi c·ª≠ quan tr·ªçng nh·∫•t. S·ª± ki√™n tr√¨ c·ªßa b·∫°n ng√†y h√¥m nay ch√≠nh l√† chi·∫øc ch√¨a kh√≥a v√†ng m·ªü ra c√°nh c·ª≠a tr∆∞·ªùng ƒë·∫°i h·ªçc Nguy·ªán v·ªçng 1 m√† b·∫°n ƒëang kh√°t khao chinh ph·ª•c.",
            "Mong r·∫±ng nƒÉm nay b·∫°n s·∫Ω tr·ªü th√†nh ni·ªÅm t·ª± h√†o l·ªõn lao c·ªßa gia ƒë√¨nh v√† th·∫ßy c√¥. Ch√∫c b·∫°n v∆∞·ª£t v≈© m√¥n th√†nh c√¥ng v·ªõi s·ªë ƒëi·ªÉm cao ngo√†i mong ƒë·ª£i, hi√™n ngang b∆∞·ªõc v√†o c·ªïng tr∆∞·ªùng ƒë·∫°i h·ªçc Nguy·ªán v·ªçng 1 v√† b·∫Øt ƒë·∫ßu nh·ªØng nƒÉm th√°ng sinh vi√™n ƒë·∫ßy nƒÉng ƒë·ªông, s√°ng t·∫°o v√† th√†nh c√¥ng r·ª±c r·ª°.",
            "Ch√∫c b·∫°n lu√¥n gi·ªØ v·ªØng phong ƒë·ªô ·ªïn ƒë·ªãnh, kh√¥ng ch·ªß quan khi g·∫∑p b√†i d·ªÖ v√† kh√¥ng n·∫£n ch√≠ tr∆∞·ªõc b√†i kh√≥. H√£y th·ªÉ hi·ªán t·∫•t c·∫£ nh·ªØng g√¨ t·ªët nh·∫•t c·ªßa m√¨nh tr√™n m·∫∑t gi·∫•y thi ƒë·ªÉ ng√†y nh·∫≠n k·∫øt qu·∫£ tr√∫ng tuy·ªÉn Nguy·ªán v·ªçng 1 s·∫Ω l√† ng√†y b·∫°n c·∫£m th·∫•y t·ª± h√†o v·ªÅ b·∫£n th√¢n nh·∫•t.",
            "NƒÉm 2026, ch√∫c b·∫°n may m·∫Øn nh∆∞ r·ªìng g·∫∑p m√¢y, l√†m b√†i thi m√¥n n√†o c≈©ng ƒë·∫°t ƒëi·ªÉm xu·∫•t s·∫Øc m√¥n ƒë√≥. Ch√∫c b·∫°n x√©t tuy·ªÉn ƒë·ª£t 1 l√† tr√∫ng tuy·ªÉn ngay v√†o Nguy·ªán v·ªçng 1, kh√¥ng c·∫ßn ph·∫£i lo l·∫Øng hay ch·ªù ƒë·ª£i th√™m b·∫•t c·ª© ƒë·ª£t b·ªï sung n√†o, c·ª© th·∫ø m√† th·∫≥ng ti·∫øn v√†o ƒë·∫°i h·ªçc!",
            "Ch√∫c b·∫°n c√≥ m·ªôt m√πa thi r·ª±c r·ª° s·∫Øc m√†u th√†nh c√¥ng v√† tr√†n ƒë·∫ßy ni·ªÅm vui chi·∫øn th·∫Øng. H√£y vi·∫øt ti·∫øp c√¢u chuy·ªán ∆∞·ªõc m∆° c·ªßa m√¨nh tr√™n m·ªôt n·ªÅn t·∫£ng v·ªØng ch·∫Øc h∆°n t·∫°i gi·∫£ng ƒë∆∞·ªùng ƒë·∫°i h·ªçc Nguy·ªán v·ªçng 1, n∆°i s·∫Ω gi√∫p b·∫°n bay cao v√† bay xa h∆°n n·ªØa tr√™n con ƒë∆∞·ªùng s·ª± nghi·ªáp sau n√†y.",
            "G·ª≠i t·ªõi b·∫°n ng√†n ng√¥i sao may m·∫Øn t·ª´ v≈© tr·ª• ƒë·ªÉ soi s√°ng con ƒë∆∞·ªùng √¥n thi c·ªßa b·∫°n. Ch√∫c b·∫°n l√†m b√†i thi th·∫≠t t·ªânh t√°o, kh√¥ng m·∫Øc b·∫•t k·ª≥ sai s√≥t ƒë√°ng ti·∫øc n√†o v√† ƒë·∫°t ƒë∆∞·ª£c t·ªïng ƒëi·ªÉm d∆∞ s·ª©c ƒë·ªÉ l·ªçt v√†o danh s√°ch tr√∫ng tuy·ªÉn c·ªßa ng√¥i tr∆∞·ªùng ƒë·∫°i h·ªçc Nguy·ªán v·ªçng 1 nh√©!",
            "Ch√∫c b·∫°n nƒÉm nay 'c√†y' ƒë·∫øn ƒë√¢u tr√∫ng ƒë·∫øn ƒë√≥, ki·∫øn th·ª©c n·∫°p v√†o ƒë·∫ßu lu√¥n ƒë∆∞·ª£c s·∫Øp x·∫øp khoa h·ªçc v√† d·ªÖ d√†ng t√°i hi·ªán khi ƒëi thi. M·ª•c ti√™u Nguy·ªán v·ªçng 1 ch·∫Øc ch·∫Øn s·∫Ω g·ªçi t√™n b·∫°n n·∫øu b·∫°n ti·∫øp t·ª•c gi·ªØ v·ªØng tinh th·∫ßn h·ªçc t·∫≠p hƒÉng say v√† quy·∫øt li·ªát nh∆∞ hi·ªán t·∫°i.",
            "NƒÉm m·ªõi, ch√∫c b·∫°n c√≥ ƒë·ªß s·ª©c kh·ªèe d·∫ªo dai v√† tr√≠ tu·ªá tinh anh ƒë·ªÉ chinh ph·ª•c m·ªçi ƒë·ªânh cao tri th·ª©c trong ch∆∞∆°ng tr√¨nh h·ªçc. Ch√∫c b·∫°n ƒë·ªó ƒë·∫°t vinh quang, nh·∫≠n ƒë∆∞·ª£c s·ª± ng∆∞·ª°ng m·ªô t·ª´ b·∫°n b√® khi ch√≠nh th·ª©c tr·ªü th√†nh t√¢n sinh vi√™n c·ªßa tr∆∞·ªùng ƒë·∫°i h·ªçc Nguy·ªán v·ªçng 1 ƒë·∫ßy danh gi√°.",
            "Ch√∫c b·∫°n lu√¥n gi·ªØ ƒë∆∞·ª£c ng·ªçn l·ª≠a ƒëam m√™ v√† s·ª± t√≤ m√≤ trong h·ªçc t·∫≠p v√¨ ƒë√≥ ch√≠nh l√† ch√¨a kh√≥a c·ªßa th√†nh c√¥ng. K·ª≥ thi 2026 s·∫Ω l√† b·ªá ph√≥ng ho√†n h·∫£o ƒë∆∞a b·∫°n bay th·∫≥ng v√†o ng√¥i tr∆∞·ªùng Nguy·ªán v·ªçng 1, n∆°i b·∫°n c√≥ th·ªÉ th·ªèa s·ª©c ph√°t tri·ªÉn b·∫£n th√¢n v√† t√†i nƒÉng.",
            "M·ª•c ti√™u l·ªõn nh·∫•t c·ªßa nƒÉm nay ch·ªâ g√≥i g·ªçn trong ba ch·ªØ: ƒê·ªó Nguy·ªán v·ªçng 1. Ch√∫c b·∫°n h·ªçc t·∫≠p chƒÉm ch·ªâ c√≥ k·∫ø ho·∫°ch, thi c·ª≠ su√¥n s·∫ª v·ªõi t√¢m l√Ω tho·∫£i m√°i v√† cu·ªëi c√πng ƒë·∫°t ƒë∆∞·ª£c s·ªë ƒëi·ªÉm l√Ω t∆∞·ªüng ƒë·ªÉ ƒë∆∞·ªùng ho√†ng b∆∞·ªõc v√†o c√°nh c·ªïng tr∆∞·ªùng ƒë·∫°i h·ªçc m√† b·∫°n y√™u th√≠ch.",
            "Ch√∫c b·∫°n nƒÉm 2026: M·ªói l·∫ßn ƒë·∫∑t b√∫t l√† m·ªôt l·∫ßn ghi ƒëi·ªÉm, m·ªói trang v·ªü √¥n t·∫≠p l√† m·ªôt b∆∞·ªõc ti·∫øn g·∫ßn h∆°n ƒë·∫øn th√†nh c√¥ng. Gi·∫•y b√°o tr√∫ng tuy·ªÉn Nguy·ªán v·ªçng 1 ch·∫Øc ch·∫Øn s·∫Ω s·ªõm n·∫±m g·ªçn trong tay b·∫°n nh∆∞ m·ªôt ph·∫ßn th∆∞·ªüng x·ª©ng ƒë√°ng cho nh·ªØng n·ªó l·ª±c phi th∆∞·ªùng v·ª´a qua.",
            "NƒÉm m·ªõi, ch√∫c b·∫°n c√≥ th·∫ßn may m·∫Øn lu√¥n c·∫≠n k·ªÅ h·ªó tr·ª£ trong su·ªët qu√° tr√¨nh l√†m b√†i thi. Nh·ªØng c√¢u h·ªèi kh√≥ s·∫Ω tr·ªü n√™n d·ªÖ d√†ng, nh·ªØng l·ª±a ch·ªçn tr·∫Øc nghi·ªám ƒë·ªÅu ƒëi ƒë·∫øn ƒë√°p √°n ch√≠nh x√°c nh·∫•t, gi√∫p b·∫°n s·ªü h·ªØu s·ªë ƒëi·ªÉm v√†ng ƒë·ªÉ b∆∞·ªõc ch√¢n v√†o Nguy·ªán v·ªçng 1.",
            "Ch√∫c b·∫°n bi·∫øt c√°ch bi·∫øn nh·ªØng √°p l·ª±c thi c·ª≠ th√†nh ƒë·ªông l·ª±c m·∫°nh m·∫Ω ƒë·ªÉ b·ª©t ph√° gi·ªõi h·∫°n c·ªßa b·∫£n th√¢n. H√£y ch·ª©ng minh cho m·ªçi ng∆∞·ªùi th·∫•y nƒÉng l·ª±c th·ª±c s·ª± c·ªßa b·∫°n b·∫±ng m·ªôt b·∫£ng ƒëi·ªÉm ch√≥i l·ªçi v√† t·∫•m v√© tr√∫ng tuy·ªÉn v√†o ƒë√∫ng ng√¥i tr∆∞·ªùng Nguy·ªán v·ªçng 1 nh√©!",
            "Ch√∫c b·∫°n m·ªôt nƒÉm 2026 kh√¥ng c√≤n lo √¢u v·ªÅ nh·ªØng con s·ªë hay ƒëi·ªÉm thi th·∫•p. M·ªçi b√†i ki·ªÉm tra v√† m√¥n thi ch√≠nh th·ª©c ƒë·ªÅu ƒë·∫°t ƒëi·ªÉm gi·ªèi tr·ªü l√™n, gi√∫p b·∫°n c√≥ m·ªôt h·ªì s∆° x√©t tuy·ªÉn ƒë·∫πp nh∆∞ m∆° v√† d·ªÖ d√†ng tr√∫ng tuy·ªÉn v√†o Nguy·ªán v·ªçng 1 ngay t·ª´ ƒë·ª£t ƒë·∫ßu ti√™n.",
            "T∆∞∆°ng lai t∆∞∆°i s√°ng v·ªõi nh·ªØng tr·∫£i nghi·ªám sinh vi√™n ƒë·∫ßy m√†u s·∫Øc ƒëang ch·ªù ƒë√≥n b·∫°n t·∫°i tr∆∞·ªùng ƒë·∫°i h·ªçc Nguy·ªán v·ªçng 1. Ch√∫c b·∫°n √¥n thi th·∫≠t t·ªët, gi·ªØ g√¨n s·ª©c kh·ªèe v√† lu√¥n tr√†n ƒë·∫ßy nƒÉng l∆∞·ª£ng t√≠ch c·ª±c ƒë·ªÉ n·∫Øm b·∫Øt l·∫•y c∆° h·ªôi tuy·ªát v·ªùi n√†y v√† t·ªèa s√°ng theo c√°ch ri√™ng.",
            "Ch√∫c b·∫°n nƒÉm nay 'b√°ch chi·∫øn b√°ch th·∫Øng' tr√™n m·ªçi m·∫∑t tr·∫≠n h·ªçc t·∫≠p v√† thi c·ª≠. ƒê·ªÅ thi THPT Qu·ªëc gia d√π c√≥ kh√≥ nh·∫±n ƒë·∫øn ƒë√¢u c≈©ng s·∫Ω b·ªã b·∫°n chinh ph·ª•c m·ªôt c√°ch thuy·∫øt ph·ª•c nh·∫•t. H√£y chu·∫©n b·ªã tinh th·∫ßn ƒë·ªÉ tr·ªü th√†nh t√¢n sinh vi√™n c·ªßa Nguy·ªán v·ªçng 1 ƒëi th√¥i!",
            "NƒÉm 2026, ch√∫c b·∫°n c√≥ m·ªôt tr√≠ tu·ªá s·∫Øc s·∫£o v√† m·ªôt c∆° th·ªÉ tr√†n ƒë·∫ßy nƒÉng l∆∞·ª£ng ƒë·ªÉ 'c√¢n' h·∫øt m·ªçi k·ª≥ thi quan tr·ªçng. Ch√∫c m·ª´ng b·∫°n tr∆∞·ªõc v√¨ tin r·∫±ng v·ªõi s·ª± chu·∫©n b·ªã k·ªπ l∆∞·ª°ng, b·∫°n ch·∫Øc ch·∫Øn s·∫Ω t√™n m√¨nh trong danh s√°ch tr√∫ng tuy·ªÉn Nguy·ªán v·ªçng 1 ƒë·∫ßy t·ª± h√†o!",
            "Ch√∫c b·∫°n lu√¥n tin t∆∞·ªüng tuy·ªát ƒë·ªëi v√†o kh·∫£ nƒÉng c·ªßa ch√≠nh m√¨nh v√¨ b·∫°n gi·ªèi h∆°n nh·ªØng g√¨ b·∫°n nghƒ© r·∫•t nhi·ªÅu. K·ª≥ thi n√†y ch·ªâ l√† m·ªôt th·ª≠ th√°ch nh·ªè ƒë·ªÉ b·∫°n kh·∫≥ng ƒë·ªãnh gi√° tr·ªã b·∫£n th√¢n v√† b∆∞·ªõc ti·∫øp v√†o m√¥i tr∆∞·ªùng ƒë·∫°i h·ªçc Nguy·ªán v·ªçng 1 ƒë·∫ßy h·ª©a h·∫πn ph√≠a tr∆∞·ªõc.",
            "NƒÉm m·ªõi ch√∫c b·∫°n h·ªçc ƒë√¢u hi·ªÉu ƒë√≥, l√†m b√†i thi m∆∞·ª£t m√† v√† tr√¥i ch·∫£y nh∆∞ √Ω mu·ªën. Khi tra c·ª©u k·∫øt qu·∫£ thi, mong r·∫±ng d√≤ng ch·ªØ 'Tr√∫ng tuy·ªÉn Nguy·ªán v·ªçng 1' s·∫Ω hi·ªán l√™n ƒë·∫ßu ti√™n, mang l·∫°i ni·ªÅm vui s∆∞·ªõng v·ª° √≤a cho b·∫°n v√† t·∫•t c·∫£ nh·ªØng ng∆∞·ªùi th√¢n y√™u.",
            "Ch√∫c b·∫°n c√≥ nh·ªØng ng∆∞·ªùi b·∫°n ƒë·ªìng h√†nh tuy·ªát v·ªùi trong m√πa thi n√†y, ƒë·ªÉ c√πng nhau chia s·∫ª ki·∫øn th·ª©c v√† c·ªï v≈© tinh th·∫ßn cho nhau. Mong r·∫±ng t·∫•t c·∫£ c√°c b·∫°n ƒë·ªÅu s·∫Ω ƒë·ªó ƒë·∫°t cao v√† c√πng nhau t·ª• h·ªçp t·∫°i gi·∫£ng ƒë∆∞·ªùng ƒë·∫°i h·ªçc Nguy·ªán v·ªçng 1 v√†o k·ª≥ nh·∫≠p h·ªçc t·ªõi.",
            "NƒÉm 2026, ch√∫c b·∫°n g·∫∑t h√°i ƒë∆∞·ª£c nh·ªØng qu·∫£ ng·ªçt ch√≠n m·ªçng sau su·ªët 12 nƒÉm mi·ªát m√†i ƒë√®n s√°ch v·∫•t v·∫£. C√°nh c·ªïng tr∆∞·ªùng ƒë·∫°i h·ªçc Nguy·ªán v·ªçng 1 ƒëang m·ªü toang ƒë·ªÉ ch√†o ƒë√≥n m·ªôt t√¢n sinh vi√™n ƒë·∫ßy t√†i nƒÉng v√† nhi·ªát huy·∫øt nh∆∞ b·∫°n, h√£y s·∫µn s√†ng ƒë·ªÉ b·∫Øt ƒë·∫ßu h√†nh tr√¨nh m·ªõi!",
            "Ch√∫c b·∫°n: S√°ng su·ªët trong t·ª´ng c√¢u h·ªèi tr·∫Øc nghi·ªám kh√°ch quan, s·∫Øc s·∫£o v√† ƒë·∫ßy t√≠nh thuy·∫øt ph·ª•c trong t·ª´ng b√†i t·ª± lu·∫≠n. V·ªõi phong ƒë·ªô ƒë·ªânh cao n√†y, vi·ªác ƒë·∫°t ƒëi·ªÉm s·ªë d·∫´n ƒë·∫ßu v√† tr√∫ng tuy·ªÉn v√†o Nguy·ªán v·ªçng 1 ch·∫Øc ch·∫Øn ch·ªâ l√† v·∫•n ƒë·ªÅ th·ªùi gian m√† th√¥i, c·ªë l√™n!",
            "G·ª≠i t·ªõi c·∫≠u t·∫•t c·∫£ nh·ªØng nƒÉng l∆∞·ª£ng t√≠ch c·ª±c v√† s·ª± may m·∫Øn nh·∫•t c·ªßa v≈© tr·ª• ƒë·ªÉ c·∫≠u v∆∞·ª£t qua m√πa thi m·ªôt c√°ch nh·∫π nh√†ng. Ch√∫c c·∫≠u lu√¥n b√¨nh tƒ©nh, t·ª± tin x·ª≠ l√Ω m·ªçi t√¨nh hu·ªëng v√† gi√†nh chi·∫øn th·∫Øng vang d·ªôi v·ªõi k·∫øt qu·∫£ ƒë·ªó v√†o ƒë√∫ng ng√¥i tr∆∞·ªùng Nguy·ªán v·ªçng 1.",
            "NƒÉm m·ªõi ch√∫c c·∫≠u th·ª±c hi·ªán ƒë∆∞·ª£c m·ªôt c√∫ 'l·ªôi ng∆∞·ª£c d√≤ng' ngo·∫°n m·ª•c n·∫øu c√≤n ƒëang lo l·∫Øng, ho·∫∑c ti·∫øp t·ª•c gi·ªØ v·ªØng phong ƒë·ªô th·ªß khoa c·ªßa m√¨nh. ƒê√≠ch ƒë·∫øn cu·ªëi c√πng l√† t·∫•m v√© v√†o ƒë·∫°i h·ªçc Nguy·ªán v·ªçng 1 s·∫Ω s·ªõm n·∫±m trong tay c·∫≠u nh∆∞ m·ªôt l·∫Ω t·∫•t y·∫øu c·ªßa s·ª± n·ªó l·ª±c!",
            "Ch√∫c b·∫°n thi xong l√† bi·∫øt m√¨nh ƒë·ªó, x√©t tuy·ªÉn l√† tr√∫ng ngay l·∫≠p t·ª©c. NƒÉm 2026 s·∫Ω l√† c·ªôt m·ªëc ƒë√°ng nh·ªõ nh·∫•t trong cu·ªôc ƒë·ªùi khi b·∫°n ch√≠nh th·ª©c tr·ªü th√†nh t√¢n sinh vi√™n c·ªßa tr∆∞·ªùng ƒë·∫°i h·ªçc Nguy·ªán v·ªçng 1, b·∫Øt ƒë·∫ßu h√†nh tr√¨nh chinh ph·ª•c nh·ªØng ƒë·ªânh cao m·ªõi c·ªßa tri th·ª©c.",
            "H√£y ƒë·ªÉ nƒÉm 2026 n√†y tr·ªü th√†nh nƒÉm r·ª±c r·ª° nh·∫•t trong qu√£ng ƒë·ªùi h·ªçc sinh c·ªßa b·∫°n v·ªõi nh·ªØng k·ª∑ ni·ªám ƒë·∫πp v√† th√†nh t√≠ch h·ªçc t·∫≠p ƒë√°ng n·ªÉ. Ch√∫c b·∫°n n·ªó l·ª±c h·∫øt m√¨nh v√† nh·∫≠n l·∫°i ƒë∆∞·ª£c k·∫øt qu·∫£ ng·ªçt ng√†o nh·∫•t: Gi·∫•y th√¥ng b√°o tr√∫ng tuy·ªÉn ch√≠nh th·ª©c v√†o ng√¥i tr∆∞·ªùng Nguy·ªán v·ªçng 1!",
            "Cu·ªëi c√πng, ch√∫c b·∫°n m·ªôt nƒÉm m·ªõi v·∫°n s·ª± nh∆∞ √Ω, t·ª∑ s·ª± nh∆∞ m∆°, h·ªçc h√†nh t·∫•n t·ªõi v√† thi c·ª≠ ƒë·ªó ƒë·∫°t vinh quang. Quan tr·ªçng nh·∫•t l√† ch√∫c b·∫°n s·ªõm nh·∫≠n ƒë∆∞·ª£c tin vui tr√∫ng tuy·ªÉn v√†o Nguy·ªán v·ªçng 1 ƒë·ªÉ c√≥ m·ªôt m√πa h√® th·∫≠t tho·∫£i m√°i v√† √Ω nghƒ©a tr∆∞·ªõc khi v√†o ƒë·∫°i h·ªçc!"
        ];

        let userName = "";
        function typeWriter(text, elementId, speed = 40) {
            let i = 0;
            const element = document.getElementById(elementId);
            element.innerHTML = "";


            function type() {
                if (i < text.length) {
                    let char = text.charAt(i);
                    if (char === '\n') {
                        element.innerHTML += '<br>';

                    } else {
                        element.innerHTML += char;
                    }
                    i++;

                    setTimeout(type, speed);
                } else {
                    document.getElementById('letter-footer').style.opacity = 1;
                    const waitMsg = document.getElementById('wait-message');
                    waitMsg.style.display = 'block';

                    waitMsg.style.animation = 'twinkle 1s infinite alternate';
                    // --- UPDATE: T·ª± ƒë·ªông chuy·ªÉn trang sau 5 gi√¢y ---
                    setTimeout(() => {

                        goToPage3();
                    }, 5000);
                }
            }
            type();
        }

        // --- UPDATED: PAGE TRANSITION LOGIC ---
        function switchPage(hideId, showId) {
            const h = document.getElementById(hideId);
            const s = document.getElementById(showId);

            h.classList.add('page-exit');
            h.classList.remove('active');

            setTimeout(() => {
                h.classList.remove('page-exit');
                h.style.display = 'none';

                if (showId === 'page-3-interactive') {
                    s.style.display = 'block';
                    s.classList.add('page-enter');
                    setTimeout(() => s.classList.remove('page-enter'), 1000);

                    // Fix: Reset scroll on entry
                    s.scrollTop = 0;


                    setTimeout(() => {
                        const sections = document.querySelectorAll('.interactive-section');
                        const observer = new IntersectionObserver((entries) => {

                            entries.forEach(entry => {
                                if (entry.isIntersecting) entry.target.classList.add('visible');
                            });
                        }, { threshold: 0.1 }); // Gi·∫£m threshold cho mobile d·ªÖ trigger

                        sections.forEach(sec => observer.observe(sec));
                    }, 100);
                } else {
                    s.classList.add('active');
                    s.classList.add('page-enter');
                    setTimeout(() => s.classList.remove('page-enter'), 1000);
                }
            }, 800);
        }

        function goToPage2() {
            const input = document.getElementById('name-input');
            if (input.value.trim() === "") {
                alert("H√£y nh·∫≠p t√™n ƒë·ªÉ ch√∫ng m√¨nh x∆∞ng h√¥ nh√©!");
                return;
            }
            userName = input.value;
            document.getElementById('display-name').innerText = userName;
            switchPage('page-1', 'page-2');
            const randomWish = wishesList[Math.floor(Math.random() * wishesList.length)];
            const content = `Ch√†o ${userName}, l√† tui ƒë√¢y.\n\n${randomWish}\n\nB·∫°n c·ªßa tui,`;
            setTimeout(() => {
                typeWriter(content, "typewriter-text", 30);
            }, 1200);
        }

        function goToPage3() {
            switchPage('page-2', 'page-3-choice');
        }

        let windowMeteorEngine = null;
        function startInteractiveMode() {
            const choice = document.getElementById('page-3-choice');
            const interactive = document.getElementById('page-3-interactive');

            choice.classList.add('page-exit');
            setTimeout(() => {
                choice.classList.remove('active', 'page-exit');
                choice.style.display = 'none';

                interactive.style.display = 'block';
                interactive.scrollTop = 0; // ƒê·∫£m b·∫£o cu·ªôn v·ªÅ ƒë·∫ßu
                
                interactive.classList.add('page-enter');
                setTimeout(() => interactive.classList.remove('page-enter'), 1000);

                initSteam(); initWindowStars();

                windowMeteorEngine = new MeteorEngine('window-meteor-canvas', true);


                const sections = document.querySelectorAll('.interactive-section');
                const observer = new IntersectionObserver((entries) => {
                    entries.forEach(entry => {
                        if (entry.isIntersecting) entry.target.classList.add('visible');
                    });

                }, { threshold: 0.1 });
                sections.forEach(sec => observer.observe(sec));
            }, 800);
        }

        function goToPage4() {
            const p3Choice = document.getElementById('page-3-choice');
            const p3Inter = document.getElementById('page-3-interactive');

            if (p3Choice.classList.contains('active')) {
                switchPage('page-3-choice', 'page-4');
            } else {
                p3Inter.classList.add('page-exit');
                setTimeout(() => {
                    p3Inter.style.display = 'none';
                    p3Inter.classList.remove('page-exit');

                    const p4 = document.getElementById('page-4');

                    p4.classList.add('active', 'page-enter');
                    setTimeout(() => p4.classList.remove('page-enter'), 1000);
                }, 800);
            }
            setTimeout(startFinale, 1500);
        }

        // --- 3. INTERACTIVE LOGIC ---
        function initSteam() {
            const wishes = ["B√¨nh an", "S·ª©c kh·ªèe", "May m·∫Øn", "H·∫°nh ph√∫c", "Th√†nh c√¥ng", "Ti·ªÅn t√†i", "Vui v·∫ª"];
            const steamCont = document.getElementById('steam-container');
            setInterval(() => {
                if (document.hidden || steamCont.offsetParent === null) return;
                const el = document.createElement('div');
                el.className = 'steam';
                el.innerText = wishes[Math.floor(Math.random() * wishes.length)];


                el.style.left = (50 + (Math.random() * 20 - 10)) + '%';
                steamCont.appendChild(el);
                setTimeout(() => el.remove(), 4000);
            }, 2500);
        }

        function lightLamp() {
            const inp = document.getElementById('wish-input-old');
            const ashDisplay = document.getElementById('ash-display');
            const flm = document.getElementById('lamp-flame');

            if (inp && inp.value.trim()) {
                flm.classList.add('flare-up');
                ashDisplay.innerText = inp.value;
                inp.value = "";
                ashDisplay.classList.add('turn-to-ash');

                setTimeout(() => {
                    inp.placeholder = "Mu·ªôn phi·ªÅn ƒë√£ bu√¥ng b·ªè.";
                }, 800);
                setTimeout(() => { flm.classList.remove('flare-up'); }, 2000);
                setTimeout(() => {
                    ashDisplay.innerText = "";
                    ashDisplay.classList.remove('turn-to-ash');
                }, 3500);
            }
        }

        function initWindowStars() {
            const layer = document.getElementById('stars-layer-window');
            if (layer.children.length > 0) return;

            for (let i = 0; i < 30; i++) {
                const s = document.createElement('div');
                const size = Math.random() * 2 + 1;

                s.style.position = 'absolute';
                s.style.width = size + 'px';
                s.style.height = size + 'px';
                s.style.borderRadius = '50%';
                s.style.background = 'white';
                s.style.opacity = Math.random();
                s.style.left = Math.random() * 100 + '%';
                s.style.top = Math.random() * 100 + '%';
                s.style.animation = `twinkle ${Math.random() * 3 + 2}s infinite ease-in-out`;

                layer.appendChild(s);
            }
        }

        function sendWish() {
            const fb = document.getElementById('window-feedback');
            const inp = document.getElementById('reflection-input');

            if (inp && inp.value.trim()) {
                inp.value = "";
                inp.placeholder = "ƒê√£ g·ª≠i v√†o v≈© tr·ª•...";
                fb.style.opacity = 1;
                if (windowMeteorEngine) {
                    for (let i = 0; i < 5; i++) {
                        setTimeout(() => windowMeteorEngine.shoot(true), i * 300);
                    }
                }
            }
        }

        function openEnvelope() {
            const quotes = [
                "S·ªëng r·ª±c r·ª° nh√©!",
                "T√¢m an, v·∫°n s·ª± an.",
                "M·∫°nh m·∫Ω v√† h·∫°nh ph√∫c.",
                "Ti·ªÅn ƒë·∫ßy t√∫i, t√¨nh ƒë·∫ßy tim.",
                "NƒÉm nay s·∫Ω t·ªët h∆°n nƒÉm c≈©.",
                "Lu√¥n y√™u ƒë·ªùi nh√©!"
            ];
            const note = document.getElementById('lucky-note');
            const env = document.querySelector('.envelope');
            if (note.style.display !== 'block') {
                note.innerText = quotes[Math.floor(Math.random() * quotes.length)];
                note.style.display = 'block';
                env.style.opacity = 0.5;
                env.style.transform = "scale(0.9)";
            }
        }

        // --- 4. FIREWORKS ENGINE (UPDATED FOR PERFORMANCE) ---
        const canvas = document.getElementById('fireworksCanvas');
        const ctx = canvas.getContext('2d');
        let width, height;
        let particles = [];
        let rockets = [];
        let fireworksActive = false;
        function resize() {
            width = window.innerWidth;
            height = window.innerHeight;
            canvas.width = width;
            canvas.height = height;
        }
        window.addEventListener('resize', resize);
        resize();
        const palettes = {
            pureWhite: { base: [255, 255, 255], secondary: [200, 200, 255] },
            gold: { base: [255, 215, 0], secondary: [255, 250, 200] },
            fire: { base: [255, 69, 0], secondary: [255, 165, 0] },
            cool: { base: [0, 191, 255], secondary: [255, 255, 255] }
        };
        class Rocket {
            constructor() {
                this.x = Math.random() * width;
                this.y = height;
                this.destY = Math.random() * (height * 0.3) + height * 0.05;
                this.speed = Math.random() * 5 + 15;
                this.vx = (Math.random() - 0.5) * 4;
                this.vy = -this.speed;
                this.color = '255, 255, 255';
                this.trail = [];
                this.dead = false;
                this.gravity = 0.25;
            }
            update() {
                this.vy += this.gravity;
                this.x += this.vx;
                this.y += this.vy;
                this.trail.push({ x: this.x, y: this.y, alpha: 1 });
                if (this.trail.length > 8) this.trail.shift();
                this.trail.forEach(t => t.alpha -= 0.15);
                if (this.vy >= -2 || this.y <= this.destY) {
                    this.dead = true;
                    createExplosion(this.x, this.y);
                }
            }
            draw() {
                ctx.beginPath();
                for (let i = 0; i < this.trail.length; i++) {
                    const t = this.trail[i];
                    ctx.fillStyle = `rgba(${this.color}, ${t.alpha})`;
                    ctx.fillRect(t.x, t.y, 2, 2);
                }
                ctx.fillStyle = `rgb(${this.color})`;
                ctx.fillRect(this.x, this.y, 3, 3);
            }
        }

        // --- UPDATED CLASS PARTICLE ---
        class Particle {
            constructor(x, y, v, colorArr, type) {
                this.x = x;
                this.y = y;
                this.vx = v.x; this.vy = v.y;
                this.rgb = colorArr;
                this.alpha = 1; this.friction = 0.95;
                this.gravity = 0.12;

                // --- THAY ƒê·ªîI: Life ng·∫Øn h∆°n ƒë·ªÉ gi·∫£m lag (kho·∫£ng 2-2.5s @ 60fps) ---
                this.life = 120 + Math.random() * 40;
                // Decay t·ª± ƒë·ªông t√≠nh ƒë·ªÉ fade out v·ª´a kh√≠t v·ªõi life
                this.decay = this.alpha / this.life;
                this.type = type;
            }
            update() {
                this.vx *= this.friction;
                this.vy *= this.friction;
                this.vy += this.gravity;
                this.x += this.vx;
                this.y += this.vy;
                // Gi·∫£m tu·ªïi th·ªç v√† ƒë·ªô m·ªù
                this.life--;
                this.alpha -= this.decay;

                if (this.type === 'strobe' && Math.random() > 0.8) this.alpha = 1;
            }
            draw() {
                // Kh√¥ng v·∫Ω n·∫øu ƒë√£ m·ªù
                if (this.alpha <= 0.05) return;
                ctx.strokeStyle = `rgba(${this.rgb[0]}, ${this.rgb[1]}, ${this.rgb[2]}, ${this.alpha})`;
                ctx.lineWidth = 1.5; ctx.beginPath();
                ctx.moveTo(this.x, this.y);
                ctx.lineTo(this.x - this.vx * 3, this.y - this.vy * 3);
                ctx.stroke();
            }
        }

        function createExplosion(x, y) {
            const types = ['sphere', 'starburst', 'ring'];
            const type = types[Math.floor(Math.random() * types.length)];
            const keys = Object.keys(palettes);
            const palette = palettes[keys[Math.floor(Math.random() * keys.length)]];
            // Gi·∫£m s·ªë l∆∞·ª£ng h·∫°t m·ªôt ch√∫t ƒë·ªÉ t·ªëi ∆∞u mobile (80-130 h·∫°t)
            const count = Math.floor(Math.random() * 50) + 80;
            for (let i = 0; i < count; i++) {
                let speed = Math.random() * 8 + 2;
                let angle = Math.random() * Math.PI * 2;
                let vx, vy;
                if (type === 'ring') {
                    speed = 6 + Math.random();
                    angle = (Math.PI * 2 / count) * i;
                }
                vx = Math.cos(angle) * speed;
                vy = Math.sin(angle) * speed;
                if (type === 'starburst') {
                    vx *= Math.random() * 0.5 + 0.5;
                    vy *= Math.random() * 0.5 + 0.5;
                }
                const color = (Math.random() > 0.3) ?
                    palette.base : palette.secondary;
                const pType = (Math.random() > 0.8) ? 'strobe' : 'normal';
                particles.push(new Particle(x, y, { x: vx, y: vy }, color, pType));
            }
            ctx.globalCompositeOperation = 'lighter';
            ctx.fillStyle = 'rgba(255, 255, 255, 0.5)';
            ctx.beginPath(); ctx.arc(x, y, 30, 0, Math.PI * 2); ctx.fill();
        }

        function loop() {
            ctx.globalCompositeOperation = 'source-over';
            ctx.fillStyle = 'rgba(10, 10, 10, 0.2)';
            ctx.fillRect(0, 0, width, height);
            ctx.globalCompositeOperation = 'lighter';
            if (fireworksActive && Math.random() < 0.05) rockets.push(new Rocket());

            for (let i = rockets.length - 1; i >= 0; i--) {
                rockets[i].update();
                rockets[i].draw();
                if (rockets[i].dead) rockets.splice(i, 1);
            }

            // --- UPDATED LOOP: Clean up particles aggressively ---
            for (let i = particles.length - 1; i >= 0; i--) {
                particles[i].update();
                particles[i].draw();
                // X√≥a h·∫°t n·∫øu h·∫øt tu·ªïi th·ªç ho·∫∑c ƒë√£ m·ªù h·∫≥n
                if (particles[i].life <= 0 || particles[i].alpha <= 0.05) {
                    particles.splice(i, 1);
                }
            }
            requestAnimationFrame(loop);
        }
        loop();

        function startFinale() {
            fireworksActive = true;
            for (let k = 0; k < 15; k++) setTimeout(() => rockets.push(new Rocket()), k * 100);

            const hny = document.getElementById('happy-new-year');
            hny.style.opacity = 1;
            hny.style.transform = "scale(1.1)";
        }
    </script>
</body>

</html>